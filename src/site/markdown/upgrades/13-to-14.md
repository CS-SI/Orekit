<!--- Copyright 2022-2025 Thales Alenia Space
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

# Upgrading from Orekit 13.X to Orekit 14.0

Version 14.0 of Orekit introduced some incompatible API changes with respect
to versions 13.x. These changes are summarized in the following table. The next
paragraphs give hints about how users should change application source code to
adapt to this new version.

| change                                                | related issues                                                      |
|-------------------------------------------------------|---------------------------------------------------------------------|
| [custom GNSS time systems](#Custom_GNSS_Time_Systems) | [issue 1775](https://gitlab.orekit.org/orekit/orekit/-/issues/1775) |
| [revamping of rinex files](#Revamping_of_Rinex_Files) | [issue 1776](https://gitlab.orekit.org/orekit/orekit/-/issues/1776) |

## Custom GNSS Time Systems

### overview of the change

In the 13.X series, `TimeSystem` was an enumerate, and therefore included only
a limited set of values, preventing it to be used for custom GNSS systems that
are not yet officially recognized by IGS. `TimeSystem` has therefore been
changed to an interface to allow for custom implementations, and a new
`PredefinedTimeSystem` enumerate has been set up containing the official
implementations.

### how to adapt existing source code

If users need to initialize a value from the predefined lists (say `GALILEO` time
system), then they should use `PredefinedTimeSystem.GALILEO` enumerate constant.
If they just need to pass around a time system that has already been created (say
parsed from some file or created from scratch by a simulator), then they should
rather use the `TimeSystem` type, as it is more general and can be used for both
predefined and custom time systems.

## Revamping of Rinex Files

### overview of the change

In the 13.X series, `RinexClock` was a flat structure that was
inconsistent with `RinexObservation` and `RinexNavigation` and had no
associated writer. The leap seconds setting in all Rinex files was
also inconsistent (in fact, it is inconsistent in the standard
themselves as LEAP SECONDS in clock file does not have the same
meaning in observation and navigation filesâ€¦). Inconsistencies have
been resolved by revamping the classes hierarchy and
`RinexClockWriter` has been created.

The change mainly implies several getters that were directly in
`RinexClock` are now available in a new `RinexClockHeader`, that the
comments are now regular instances of `RinexComment` that can be
accessed individually instead of being a single concatenated string,
and that the getters and setters for leap seconds now explicitly
states whereas they correspond to the separation between UTC and TAI
or to the separation between UTC and GNSS (really GPS).

### how to adapt existing source code

Users should access the data from the header by first retrieving the
header using `rinexClock.getHeader()`, and then access the relevant
data (using for example `rinexClockHeader.getReceivers()`). The value
returned by `rinexClock.getComments()` is now a list of
`RinexComment`, each instance containing the line number and the
text. The `{get|set}LeapSeconds` and `{get|set}NumberOfLeapSeconds`
methods have been replaced by `{get|set}LeapSecondsTAI` and
`{get|set}LeapSecondsGNSS`.
